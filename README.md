# Agressive_audio_marks

### Что делает
Извлекает маркеры агрессивности речи
<ul>
  <li>Резкое изменение громкости</li>
  <li>Темп (количество слов в минуту)</li>
  <li>Эмоциональное состояние</li>
</ul>

### Установка зависимостей

```
pip install -r requirements.txt
```

### Описание 

Файл pipeline.py  содержит функции для вычисления темпа речи, резких изменений громкости, обращается к файлу, необходимому для выделения эмоций (Torch_emotion.py).
Функция sound_markers, находящаяся в файле pipeline.py по умолчанию принимает на вход путь к файлу (аудио/видео) и возвращает словарь маркеров, возможно уточнение временных промежутков (timestamps) - пример: [[('start', 2), ('end', 10)], [('start1', 30), ('end1', 37)]], флаг annotation указывает на то, выводить маркеры в консоль, или нет.

AudioModel.py содержит класс модели, веса которой находятся в папке model.
Utils.py содержит функцию chunkizer, используeмую для разбиения сигнала на фрагменты заданной длительности

### Пример использования
```python
markers = []
markers.append(sound_markers(video_path,  name=video_path, annotation=True))
```
Громкость была резко повышена на: 4.505 секунде
Темп речи: 120.2

Громкость была резко повышена на: 8.777 секунде
Темп речи: 120.2

Громкость была резко повышена на: 11.138 секунде
Темп речи: 132.5

Громкость была резко повышена на: 16.339 секунде
Темп речи: 132.5

```
visualize_emos(markers[0])
```
![123](https://user-images.githubusercontent.com/34346831/176686752-f3c922a9-b5bc-4138-916e-a6763ab2b441.png)

### Демонстрация мультимодального детектирования агрессии
Анализ невербальных маркеров позволяет выявить маркеры агрессии и сопоставить их с текстовой и звуковой модальностями.

Выход:
![gif (online-video-cutter com)](https://user-images.githubusercontent.com/83948828/176669174-82891331-7328-434e-bf2a-98ce291ab146.gif)

Временное окно 10 секунд;

*Пример содержится в блокноте demonstration.ipynb*
